## 11장 DIP: 의존성 역전 원칙

의존성 역전 원칙DIP에서 말하는 '유연성이 극대화된 시스템'이란 소스 코드 의존성이 추상abstraction에 의존하며 구체concretion에는 의존하지 않는 시스템이다.

정적 타입 언어나 동적 타입 언어 모두 인터페이스나 추상 클래스 같은 추상적인 선언만을 참조해야 한다는 뜻이다.

이아이디어를 규칙으로 보기에는 비현실적인데 자바의 String은 구체 클래스고 이걸 애써 추상 클래스로 만들려는 시도는 현실성이 없다.

의존하지 않도록 피하고자 하는 것은 변동성이 큰 volatile 구체적인 요소다.
이 요소는 열심히 개발하는 중이라 자주 변경될 수밖에 없는 모듈들이다.

### 안정된 추상화

인터페이스는 구현체보다 변동성이 낮다. 구현체가 변경 되더라도 인터페이스는 거의 변경될 필요가 없기 때문이다.
인터페이스를 변경하지 않고도 구현체에 기능을 추가할 수 있는 방법을 찾기 위해 노력하는데, 이는 소프트웨어 설계의 기본이다.
안정된 소프트웨어 아키텍처란 변동성이 큰 구현체에 의존하는 일은 지양하고, 안정된 추상 인터페이스를 선호하는 아키텍처라는 뜻이다.

- 변동성이 큰 구체 클래스를 참조하지 말라.
- 변동성이 큰 구체 클래스로부터 파생하지 말라
- 구체 함수를 오버라이드 하지 말라.
- 구체적이며 변동성이 크다면 절대로 그 이름을 언급하지 말라.

### 팩토리

변동성이 큰 구체적인 객체는 특별히 주의해서 생성해야 한다.
구체적의 정의한 코드에 대해 소스 코드 의존성이 발생하기 때문이다.
이처럼 바람직하지 못한 의존성을 처리할 때 추상 팩토리를 사용한다.

### 구체 컴포넌트

구체 컴포넌트에 구체적인 의존성이 있다면 이는 DIP에 위배될 수 있다. DIP 위배를 모두 없앨 수는 없다.
하지만 DIP를 위배하는 클래스들은 적은 수의 구체 컴포넌트 내부로 모을 수 있고, 이를 통해 시스템의 나머지 부분과 분리할 수 있다.

### 결론

의존성의 경계는 더 추상적인 엔티티가 있는 쪽으로만 향한다.
이 규칙은 의존성 규칙Dependency Rule이라 부를 것이다.