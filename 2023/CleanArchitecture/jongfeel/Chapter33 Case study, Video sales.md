## 33장 사례 연구: 비디오 판매

### 제품

웹 사이트에서 비디오를 판매하는 소프트웨어.
비디오를 개인과 기업에게 웹을 통해 판매한다.
개인은 단품 가격을 지불해 스트리밍으로 보거나, 더 높은 가격을 내고 비디오를 다운로드해서 영구 소장할 수 있다.
기업은 스트리밍 전용이며, 대량 구매를 하면 할인을 받을 수 있다.

개인은 시청자인 동시에 구매자다.
기업은 다른 사람들이 시청할 비디오를 구매하는 사람이 따로 있다.

비디오 제작자는 파일과 비디오 설명, 부속 파일을 제공해야 한다. 부속 파일에는 시험, 문제, 해법, 소스 코드 등이 포함된다.

관리자는 신규 비디오 시리즈를 추가하거나 기존 비디오를 추가 삭제하며, 다양한 라이선스에 맞춰 가격을 책정한다.

```
의견)
현재 유명한 비디오(?) 판매 웹 사이트는 다 구독형이고
여기에 나와 있는 예제처럼 판매하는 방식은
네이버의 시리즈온이 유일하다고 볼 수 있다.
그마저도 멤버십 구독 서비스와 같이 제공하고 있다.
```

### 유스케이스 분석

<img width="505" alt="image" src="https://user-images.githubusercontent.com/17442457/232322762-6408675f-f71f-403a-ac2e-32ca0a8e68d8.png">

4 개의 액터는 시스템이 변경되어야 할 네 가지 주요 근원이 된다.

로그인 유스케이스는 생략했는데 이를 포함한 유스케이스를 포함하면 양이 많고 복잡해진다.

점선으로 된 유스케이스는 추상 유스케이스다. 이는 범용적인 정책을 담고 있으며 다른 유스케이스에서 더 구체화한다.
추상 유스케이스가 없어도 기능에 문제는 없다. 하지만 유스케이스가 너무 비슷한 기능을 하기 때문에 유사성을 식별해서 분석 초기에 통합하는 방법을 찾는 것이 더 현명하다고 판단할 수도 있다.

### 컴포넌트 아키텍처

<img width="496" alt="image" src="https://user-images.githubusercontent.com/17442457/232322974-1d0c5f7f-a72a-4146-9524-9b8e98cdf2d3.png">

이중으로 된 선은 아키텍처의 경계이다. 각 컴포넌트는 단일 .jar 혹은 .dll 파일이다. 컴포넌트는 각각 자신에게 할당된 뷰, 프레젠터, 인터랙터, 컨트롤러를 포함한다.

각 컴포넌트를 독립적으로 컴파일하고 빌드할 수 잇는 선택지를 열어두면, 나중에 시스템이 변경되는 양상에 맞춰 시스템 배포 방식을 조정할 수 있다.

### 의존성 관리

대다수의 화살표가 왼쪽에서 오른쪽으로 향한다는 것은 아키텍처가 의존성 규칙을 준수하기 때문이다. 의존성은 경계선을 한 방향으로만 가로지르고 항상 더 높은 수준의 정책을 포함하는 컴포넌트를 향한다.

사용 관계(열린 화살표)는 제어 흐름과 같은 방향을 가리키며, 
상속 관계(닫힌 화살표)는 제어 흐름과는 반대 방향을 가리킨다.
이는 개방 폐쇄 원칙을 적용했음을 보여준다.

### 결론

33.2의 아키텍처 다이어그램은 단일 책임 원칙에 기반한 액터의 분리와 의존성 규칙의 개념을 포함하고 있다.
서로 다른 이유와 속도로 변경되는 컴포넌트를 분리하는데 목적이 있는데
이유는 액터와 관련이 있고, 속도는 정책 수준과 관련이 있다.

이런 방식으로 코드를 구조화하고 나면 시스템을 실제 배포하는 방식은 다양하게 선택할 수 있게 된다.
상황에 맞는 컴포넌트들을 배포 가능한 단위로 묶을 수도 있고, 상황이 변하면 변한 상황에 맞춰 묶는 단위를 바꾸기도 쉬워진다.